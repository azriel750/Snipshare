generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Utilisateur {
  identifiant_utilisateur Int         @id @default(autoincrement())
  email                   String      @unique
  motdepasse_hash         String
  creer_le                DateTime    @default(now())
  snippets                Snippet[]
  aimer                   aimer[]
  commenter               commenter[]
}

model Snippet {
  identifiant_snippet     Int          @id @default(autoincrement())
  titre                   String?
  code                    String?
  langage                 String?
  visibilite              String?
  creer_le                DateTime     @default(now())
  identifiant_utilisateur Int
  utilisateur             Utilisateur  @relation(fields: [identifiant_utilisateur], references: [identifiant_utilisateur])
  aimer                   aimer[]
  commenter               commenter[]
  snippetTag              snippetTag[]
}

model Tag {
  identifiant_tag Int          @id @default(autoincrement())
  name            String       @unique
  snippetTag      snippetTag[]
}

model aimer {
  identifiant_utilisateur Int
  identifiant_snippet     Int
  utilisateur             Utilisateur @relation(fields: [identifiant_utilisateur], references: [identifiant_utilisateur])
  snippet                 Snippet     @relation(fields: [identifiant_snippet], references: [identifiant_snippet])

  @@id([identifiant_utilisateur, identifiant_snippet])
}

model commenter {
  identifiant_utilisateur Int
  identifiant_snippet     Int
  date_                   DateTime    @default(now())
  texte                   String?
  utilisateur             Utilisateur @relation(fields: [identifiant_utilisateur], references: [identifiant_utilisateur])
  snippet                 Snippet     @relation(fields: [identifiant_snippet], references: [identifiant_snippet])

  @@id([identifiant_utilisateur, identifiant_snippet])
}

model snippetTag {
  snippetId Int
  tagId     Int
  snippet   Snippet @relation(fields: [snippetId], references: [identifiant_snippet])
  tag       Tag     @relation(fields: [tagId], references: [identifiant_tag])

  @@id([snippetId, tagId])
}
